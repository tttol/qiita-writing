---
title: formのonsubmitが実行されないケース
tags:
  - HTML
private: false
updated_at: '2020-02-07T13:04:03+09:00'
id: 18a1af485a407b4efab9
organization_url_name: null
slide: false
ignorePublish: false
---
formに`onsubmit`を付けているとき、例えば以下のようにすると`calledBeforeSubmit();`が実行されない。

```html
<form action="/hoge" onsubmit="return calledBeforeSubmit();">
	<input type="hidden" name="hiddenValue" value="fuga">
	<input type="button" onclick="this.form.submit();"><!-- ここが駄目 -->
</form>

<script type="text/javascript">
const calledBeforeSubmit = () => {
	// 処理...
	return true;
};
</script>
```
どうやら`<input type="button" onclick="this.form.submit();">`のようにonclick属性からformをsubmitするとonsubmitが実行されないぽい。

以下のように素直に`<input type="submit">`を使う必要がある。

```html
<form action="/hoge" onsubmit="return calledBeforeSubmit();">
	<input type="hidden" name="hiddenValue" value="fuga">
	<input type="submit"><!-- これなら大丈夫 -->
</form>

<script type="text/javascript">
const calledBeforeSubmit = () => {
	// 処理...
	return true;
};
</script>
```

調べてみると、[MDNのドキュメント](https://developer.mozilla.org/ja/docs/Web/API/HTMLFormElement/submit)にこんなことが書いてあった。

> Gecko ベースのアプリケーションからこのメソッドを呼び出すときに、フォームの onsubmit イベントハンドラ (例 : onsubmit="return false;") はトリガされません。一般的に、ユーザエージェントによる呼び出しは保証されていません (※参照 : http://lists.w3.org/Archives/Public/www-dom/2012JanMar/0011.html)

「Gecko ベースのアプリケーション」が何なのかはイマイチわからないが、ブラウザのUserAgentにはよく「Gecko」という単語を見かけるので、おそらくそれの事なんじゃないかと思っている。
